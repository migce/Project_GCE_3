{% extends 'main/base.html' %}

{% block title %}Raw Signals - Project GCE 3{% endblock %}

{% block content %}
<div class="card">
  <div class="card-header">
    <h2 class="card-title">Raw Signals Overview</h2>
    <p class="card-subtitle">Configured trading systems and last bars per timeframe</p>
  </div>
  <div class="card-body">
    {% if systems %}
      <div class="dashboard-grid">
        {% for s in systems %}
        <div class="metric-card" style="text-align: left;">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <h3 style="margin:0;">{{ s.system_sid }}</h3>
            <span class="badge" style="background:#667eea; color:#fff; padding:0.25rem 0.5rem; border-radius:4px;">{{ s.timeframes_count }} TF</span>
          </div>
          <div style="color:#6c757d; margin-top:0.25rem;">Symbol: {{ s.symbol }}</div>
          <div style="margin-top:1rem;">
            {% if s.timeframes %}
            <table class="table" style="width:100%;">
              <thead>
                <tr>
                  <th style="width:30%;">Timeframe</th>
                  <th style="width:50%;">Last Bar (Server)</th>
                  <th style="width:20%;">UTC</th>
                </tr>
              </thead>
              <tbody>
                {% for tf in s.timeframes %}
                <tr>
                  <td>{{ tf.timeframe }}{% if tf.level %} (L{{ tf.level }}){% endif %}</td>
                  <td>
                    {% if tf.last_server_dt %}
                      {{ tf.last_server_dt|date:"Y-m-d H:i:s" }}
                    {% else %}
                      <span style="color:#6c757d;">No data</span>
                    {% endif %}
                  </td>
                  <td>
                    {% if tf.last_dt %}
                      {{ tf.last_dt|date:"Y-m-d H:i:s" }}
                    {% else %}
                      -
                    {% endif %}
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
            {% else %}
              <div style="color:#6c757d;">No timeframes configured.</div>
            {% endif %}
          </div>
        </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="alert alert-info">No trading systems configured.</div>
    {% endif %}
  </div>
</div>
{% endblock %}
